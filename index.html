<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
<title>Sapu Portfolio</title>
<style>
  /* Reset and base */
  * {
    box-sizing: border-box;
  }
  body {
    margin: 0; padding: 0;
    font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, #d9f2ff 0%, #a6d8ff 100%);
    color: #0a214a;
    display: flex;
    flex-direction: column;
    min-height: 100vh;
    height: 100vh;
    max-width: 100vw;
    overflow: hidden;
  }
  header {
    padding: 1.2rem 1.5rem;
    background: #8ec9ff;
    box-shadow: 0 4px 10px rgba(62, 144, 221, 0.5);
    font-weight: 700;
    font-size: 1.8rem;
    letter-spacing: 0.08em;
    text-align: center;
    user-select: none;
    color: white;
    text-shadow: 1px 1px 5px rgba(0,0,0,0.15);
  }
  main {
    flex-grow: 1;
    display: flex;
    flex-direction: column;
    overflow-y: auto;
    padding: 1.5rem 1rem 2rem;
  }
  .hidden {
    display: none !important;
  }
  /* Login Section */
  #login-section {
    max-width: 340px;
    margin: 1.5rem auto;
    padding: 2.5rem 2rem;
    background: white;
    border-radius: 12px;
    box-shadow: 0 8px 20px rgba(62, 144, 221, 0.2);
    border: 2px solid #5db2ff;
    transition: box-shadow 0.3s ease;
  }
  #login-section:hover {
    box-shadow: 0 12px 24px rgba(62, 144, 221, 0.4);
  }
  #login-section h2 {
    margin-bottom: 1.3rem;
    font-weight: 800;
    font-size: 1.4rem;
    text-align: center;
    color: #0a214a;
    text-transform: uppercase;
    letter-spacing: 0.1em;
  }
  #login-section input[type="password"] {
    width: 100%;
    padding: 0.75rem 1rem;
    font-size: 1.1rem;
    border-radius: 8px;
    border: 2px solid #a6d8ff;
    outline-offset: 3px;
    margin-bottom: 1.3rem;
    transition: border-color 0.3s ease, box-shadow 0.3s ease;
  }
  #login-section input[type="password"]:focus {
    border-color: #58aeff;
    box-shadow: 0 0 6px #58aeff80;
  }
  #login-section button {
    width: 100%;
    padding: 0.85rem 0;
    border: none;
    border-radius: 8px;
    background: #58aeff;
    color: white;
    font-weight: 700;
    font-size: 1.1rem;
    cursor: pointer;
    transition: background-color 0.3s ease, box-shadow 0.3s ease;
    box-shadow: 0 4px 10px #58aeffaa;
  }
  #login-section button:hover {
    background: #3e8ce0;
    box-shadow: 0 6px 15px #3e8ce0dd;
  }
  #login-error {
    color: #d93535;
    font-size: 1rem;
    font-weight: 600;
    text-align: center;
    min-height: 1.4rem;
    margin-top: 0.4rem;
    user-select: none;
  }

  /* Uploader Section */
  #uploader-section {
    max-width: 460px;
    margin: 1.5rem auto;
    background: white;
    border-radius: 14px;
    padding: 2rem 2.2rem;
    box-shadow: 0 8px 26px rgba(62, 144, 221, 0.25);
    border: 2px solid #7dbfff;
    transition: box-shadow 0.3s ease;
  }
  #uploader-section:hover {
    box-shadow: 0 12px 30px rgba(62, 144, 221, 0.5);
  }
  #uploader-section h2 {
    margin-top: 0;
    font-weight: 800;
    font-size: 1.6rem;
    margin-bottom: 1.5rem;
    text-align: center;
    color: #0a214a;
    letter-spacing: 0.05em;
  }
  #project-title, #youtube-url, #video-file {
    width: 100%;
    font-size: 1rem;
    margin-bottom: 1.2rem;
    border-radius: 8px;
    border: 2px solid #a6d8ff;
    padding: 0.7rem 1rem;
    transition: border-color 0.3s ease, box-shadow 0.3s ease;
    font-weight: 600;
    color: #0a214a;
  }
  #project-title:focus, #youtube-url:focus, #video-file:focus {
    border-color: #58aeff;
    box-shadow: 0 0 8px #58aeffcc;
    outline: none;
  }
  #upload-btn {
    width: 100%;
    background: #42b883;
    color: white;
    border: none;
    font-weight: 800;
    padding: 0.85rem 0;
    border-radius: 10px;
    cursor: pointer;
    font-size: 1.1rem;
    box-shadow: 0 5px 12px #42b883cc;
    transition: background-color 0.3s ease, box-shadow 0.3s ease;
  }
  #upload-btn:hover:not(:disabled) {
    background: #339966;
    box-shadow: 0 7px 18px #339966cc;
  }
  #upload-btn:disabled {
    background: #9ce0c9;
    cursor: not-allowed;
    box-shadow: none;
  }
  #logout-btn {
    margin-top: 1.2rem;
    width: 100%;
    background: #ff5c5c;
    color: white;
    font-weight: 700;
    padding: 0.65rem 0;
    border: none;
    border-radius: 10px;
    cursor: pointer;
    font-size: 1.05rem;
    box-shadow: 0 4px 12px #ff5c5caa;
    transition: background-color 0.3s ease, box-shadow 0.3s ease;
  }
  #logout-btn:hover {
    background: #d93f3f;
    box-shadow: 0 6px 18px #d93f3fdd;
  }
  #upload-msg {
    text-align: center;
    color: #155724;
    background-color: #c7f4d2;
    padding: 0.6rem;
    border-radius: 6px;
    font-size: 1rem;
    margin-bottom: 1.3rem;
    font-weight: 700;
    box-shadow: 0 2px 8px #96dba4cc;
  }
  /* Projects Section */
  #projects-section {
    max-width: 1100px;
    margin: auto;
    padding-bottom: 2rem;
  }
  #projects-section h2 {
    font-weight: 900;
    font-size: 2.2rem;
    margin-bottom: 1.5rem;
    text-align: center;
    color: #064273;
    text-shadow: 0 0 5px #94caffaa;
    letter-spacing: 0.09em;
  }
  #projects-list {
    display: grid;
    grid-template-columns: repeat(auto-fit,minmax(300px,1fr));
    gap: 1.6rem;
  }
  .project-card {
    background: white;
    border-radius: 14px;
    box-shadow: 0 6px 18px rgba(62, 144, 221, 0.15);
    padding: 1rem 1rem 1.3rem;
    display: flex;
    flex-direction: column;
    transition: transform 0.2s ease, box-shadow 0.3s ease;
    cursor: default;
  }
  .project-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 12px 30px rgba(62, 144, 221, 0.3);
  }
  .project-title {
    font-weight: 700;
    font-size: 1.2rem;
    margin: 0.65rem 0 0.5rem;
    color: #20406c;
    text-align: center;
    text-transform: capitalize;
    letter-spacing: 0.02em;
  }
  .project-date {
    font-size: 0.95rem;
    color: #6a7b99;
    text-align: center;
    font-weight: 600;
    margin-bottom: 1rem;
    font-style: italic;
  }
  video, iframe {
    border-radius: 10px;
    width: 100%;
    height: 190px;
    background: #000;
    outline: none;
    box-shadow: 0 2px 14px rgba(0,0,0,0.25);
  }
  /* Scrollbar tweak */
  main::-webkit-scrollbar {
    width: 10px;
  }
  main::-webkit-scrollbar-thumb {
    background-color: #89b7ff;
    border-radius: 8px;
    border: 2px solid #d9f2ff;
  }

  /* Uploader toggle button (bottom right corner) */
  #uploader-toggle-btn {
    position: fixed;
    bottom: 20px;
    right: 20px;
    background: #58aeff;
    color: white;
    border: none;
    border-radius: 30px;
    padding: 0.55rem 1.1rem;
    font-weight: 700;
    font-size: 1rem;
    cursor: pointer;
    box-shadow: 0 6px 20px #58aeffcc;
    z-index: 1000;
    user-select: none;
    transition: background-color 0.3s ease, box-shadow 0.3s ease;
  }
  #uploader-toggle-btn:hover {
    background: #3d90e8;
    box-shadow: 0 9px 30px #3d90e8cc;
  }

  /* Responsive and mobile friendly */
  @media (max-width: 600px) {
    body {
      font-size: 15px;
    }
    #projects-list {
      grid-template-columns: 1fr;
    }
    video, iframe {
      height: 170px;
    }
    #uploader-section, #login-section {
      width: 90%;
      padding: 1.3rem 1rem;
      margin: 1.5rem auto;
    }
    header {
      font-size: 1.6rem;
      padding: 1rem 1rem;
    }
    #uploader-toggle-btn {
      font-size: 0.95rem;
      padding: 0.5rem 0.9rem;
      bottom: 15px;
      right: 15px;
    }
  }
</style>
</head>
<body>
<header>Sapu Portfolio</header>
<main>
  <!-- Login Section -->
  <section id="login-section" class="hidden" aria-label="Uploader Login Section">
    <h2>Uploader Login</h2>
    <input id="password-input" type="password" placeholder="Enter upload password" aria-label="Upload password"/>
    <button id="login-btn" type="button">Login</button>
    <div id="login-error" aria-live="assertive"></div>
  </section>

  <!-- Uploader Section -->
  <section id="uploader-section" class="hidden" aria-label="Project Video Uploader">
    <h2>Upload New Project</h2>
    <input id="project-title" type="text" placeholder="Project title" aria-label="Project title"/>
    <input id="video-file" type="file" accept="video/*" aria-label="Select video file"/>
    <input id="youtube-url" type="text" placeholder="YouTube Video URL" aria-label="YouTube video URL"/>
    <button id="upload-btn" type="button" disabled>Upload Project</button>
    <div id="upload-msg" role="alert" aria-live="polite" class="hidden"></div>
    <button id="logout-btn" type="button">Logout</button>
  </section>

  <!-- Projects List Section (Always visible to all) -->
  <section id="projects-section" aria-label="Uploaded Projects">
    <h2>My Projects</h2>
    <div id="projects-list" aria-live="polite" aria-relevant="additions"></div>
  </section>
</main>

<button id="uploader-toggle-btn" aria-label="Open uploader login">Uploader</button>

<script>
  (function() {
    const PASSWORD = "12345aedf."; // Password for uploading
    const loginSection = document.getElementById("login-section");
    const uploaderSection = document.getElementById("uploader-section");
    const projectsList = document.getElementById("projects-list");
    const loginBtn = document.getElementById("login-btn");
    const passwordInput = document.getElementById("password-input");
    const projectTitleInput = document.getElementById("project-title");
    const videoFileInput = document.getElementById("video-file");
    const youtubeUrlInput = document.getElementById("youtube-url");
    const uploadBtn = document.getElementById("upload-btn");
    const loginError = document.getElementById("login-error");
    const uploadMsg = document.getElementById("upload-msg");
    const logoutBtn = document.getElementById("logout-btn");
    const uploaderToggleBtn = document.getElementById("uploader-toggle-btn");

    // Storage key for projects
    const STORAGE_KEY = "portfolio_projects";

    // State
    let loggedIn = false;
    let uploaderInterfaceVisible = false; // controls showing login/uploader

    // Utilities
    function saveProjects(projects) {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(projects));
    }
    function loadProjects() {
      const data = localStorage.getItem(STORAGE_KEY);
      if (!data) return [];
      try {
        return JSON.parse(data);
      } catch (e) {
        return [];
      }
    }

    // Parse YouTube ID from URL helper
    function parseYouTubeId(url) {
      try {
        const regExp = /^.*(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))([^#&?]*).*/;
        const match = url.match(regExp);
        return (match && match[1].length === 11) ? match[1] : null;
      } catch {
        return null;
      }
    }

    // Render projects with support for local videos and YouTube links
    function renderProjects() {
      projectsList.innerHTML = '';
      const projects = loadProjects();
      if (projects.length === 0) {
        projectsList.innerHTML = '<p style="text-align:center;color:#444; font-weight: 600;">No projects uploaded yet</p>';
        return;
      }
      projects.forEach(p => {
        const card = document.createElement("div");
        card.className = "project-card";

        const title = document.createElement("h3");
        title.className = "project-title";
        title.textContent = p.title;

        const date = document.createElement("p");
        date.className = "project-date";
        date.textContent = `Uploaded on: ${p.date}`;

        card.appendChild(title);
        card.appendChild(date);

        if (p.videoData.startsWith("http")) {
          // Treat as YouTube URL
          const videoId = parseYouTubeId(p.videoData);
          if (videoId) {
            const iframe = document.createElement("iframe");
            iframe.setAttribute("src", `https://www.youtube.com/embed/${videoId}`);
            iframe.setAttribute("allowfullscreen", "");
            iframe.setAttribute("aria-label", `YouTube video of project: ${p.title}`);
            iframe.setAttribute("frameborder", "0");
            card.appendChild(iframe);
          } else {
            // If invalid URL, show a link
            const link = document.createElement("a");
            link.href = p.videoData;
            link.target = "_blank";
            link.rel = "noopener noreferrer";
            link.textContent = "View video";
            link.style.textAlign = "center";
            link.style.marginTop = "10px";
            card.appendChild(link);
          }
        } else {
          // Local video base64 data
          const video = document.createElement("video");
          video.setAttribute("controls", "");
          video.setAttribute("preload", "metadata");
          video.src = p.videoData;
          video.setAttribute("aria-label", `Video of project: ${p.title}`);
          card.appendChild(video);
        }

        projectsList.appendChild(card);
      });
    }

    // Update UI based on login status and uploader interface state
    function updateUI() {
      if (!uploaderInterfaceVisible) {
        // Hide both login and uploader sections, only projects visible
        loginSection.classList.add("hidden");
        uploaderSection.classList.add("hidden");
        uploaderToggleBtn.textContent = "Uploader";
      } else {
        uploaderToggleBtn.textContent = "Close";
        if (loggedIn) {
          loginSection.classList.add("hidden");
          uploaderSection.classList.remove("hidden");
          passwordInput.value = "";
          loginError.textContent = "";
        } else {
          loginSection.classList.remove("hidden");
          uploaderSection.classList.add("hidden");
        }
      }
    }

    // Check form validity to enable upload button
    function checkUploadFormValidity() {
      if (projectTitleInput.value.trim() && (videoFileInput.files.length === 1 || youtubeUrlInput.value.trim())) {
        uploadBtn.disabled = false;
      } else {
        uploadBtn.disabled = true;
      }
    }

    // Event Handlers
    loginBtn.addEventListener("click", () => {
      const entered = passwordInput.value;
      if (entered === PASSWORD) {
        loggedIn = true;
        loginError.textContent = "";
        passwordInput.value = "";
        updateUI();
      } else {
        loginError.textContent = "Incorrect password.";
      }
    });
    passwordInput.addEventListener("keypress", e => {
      if (e.key === "Enter") {
        loginBtn.click();
      }
    });

    logoutBtn.addEventListener("click", () => {
      loggedIn = false;
      uploadMsg.classList.add("hidden");
      projectTitleInput.value = "";
      videoFileInput.value = "";
      youtubeUrlInput.value = "";
      uploadBtn.disabled = true;
      updateUI();
    });

    projectTitleInput.addEventListener("input", checkUploadFormValidity);
    videoFileInput.addEventListener("change", () => {
      if (videoFileInput.files.length > 0) {
        youtubeUrlInput.value = "";
      }
      checkUploadFormValidity();
    });
    youtubeUrlInput.addEventListener("input", () => {
      if (youtubeUrlInput.value.trim().length > 0) {
        videoFileInput.value = "";
      }
      checkUploadFormValidity();
    });

    uploadBtn.addEventListener("click", () => {
      if (!loggedIn) return;
      const title = projectTitleInput.value.trim();
      const file = videoFileInput.files[0];
      const youtubeUrl = youtubeUrlInput.value.trim();
      const currentDate = new Date().toLocaleDateString(); // Get current date

      if (!title || (!file && !youtubeUrl)) return;

      // Limit file size to 100MB to avoid browser issues
      if (file && file.size > 100 * 1024 * 1024) {
        uploadMsg.textContent = "File too large (max 100MB).";
        uploadMsg.classList.remove("hidden");
        return;
      }

      uploadBtn.disabled = true;
      uploadMsg.textContent = "Uploading...";
      uploadMsg.classList.remove("hidden");

      const projects = loadProjects();
      if (file) {
        const reader = new FileReader();
        reader.onload = e => {
          const videoData = e.target.result;
          projects.push({ title, videoData, date: currentDate }); // Save date with project
          saveProjects(projects);

          uploadMsg.textContent = "Upload successful!";
          projectTitleInput.value = "";
          videoFileInput.value = "";
          uploadBtn.disabled = true;

          renderProjects();

          setTimeout(() => {
            uploadMsg.classList.add("hidden");
          }, 3000);
        };
        reader.onerror = () => {
          uploadMsg.textContent = "Error reading file.";
        };
        reader.readAsDataURL(file);
      } else if (youtubeUrl) {
        projects.push({ title, videoData: youtubeUrl, date: currentDate }); // Save date with project
        saveProjects(projects);

        uploadMsg.textContent = "Upload successful!";
        projectTitleInput.value = "";
        youtubeUrlInput.value = "";
        uploadBtn.disabled = true;

        renderProjects();

        setTimeout(() => {
          uploadMsg.classList.add("hidden");
        }, 3000);
      }
    });

    uploaderToggleBtn.addEventListener("click", () => {
      uploaderInterfaceVisible = !uploaderInterfaceVisible;
      if (!uploaderInterfaceVisible) {
        loggedIn = false; // logout when closing uploader
      }
      uploadMsg.classList.add("hidden");
      loginError.textContent = "";
      projectTitleInput.value = "";
      videoFileInput.value = "";
      youtubeUrlInput.value = "";
      uploadBtn.disabled = true;
      updateUI();
    });

    // Initialize
    renderProjects();
    updateUI();
  })();
</script>
</body>
</html>

